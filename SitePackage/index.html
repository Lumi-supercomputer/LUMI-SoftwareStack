
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Technical documentation for the LUMI software stack">
      
      
      
        <link rel="canonical" href="https://Lumi-supercomputer.github.io/LUMI-SoftwareStack/SitePackage/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>The contents of the SitePackage.lua file - LUMI Software Stack technical documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lumi-prototype-sitepackagelua" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="LUMI Software Stack technical documentation" class="md-header__button md-logo" aria-label="LUMI Software Stack technical documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LUMI Software Stack technical documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The contents of the SitePackage.lua file
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent=""  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Lumi-supercomputer/LUMI-SoftwareStack/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="LUMI Software Stack technical documentation" class="md-nav__button md-logo" aria-label="LUMI Software Stack technical documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LUMI Software Stack technical documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Lumi-supercomputer/LUMI-SoftwareStack/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../whats_new/" class="md-nav__link">
        What's new or different?
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../start_on_LUMI_pilot/" class="md-nav__link">
        Installation instructions for the pilot phase
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../module_setup/" class="md-nav__link">
        Setup of the LUMI module system
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../easybuild_setup/" class="md-nav__link">
        EasyBuild setup
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../CrayPE_integration/" class="md-nav__link">
        Cray PE integration
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../procedures/" class="md-nav__link">
        Some procedures
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../directory_structure/" class="md-nav__link">
        Installation directory structure
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../files_used/" class="md-nav__link">
        Overview of files
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          The contents of the SitePackage.lua file
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        The contents of the SitePackage.lua file
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#settings" class="md-nav__link">
    Settings
  </a>
  
    <nav class="md-nav" aria-label="Settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#target-modules-per-partition" class="md-nav__link">
    Target modules per partition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-programming-environment" class="md-nav__link">
    Default programming environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-of-lts-software-stacks" class="md-nav__link">
    List of LTS software stacks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hooks" class="md-nav__link">
    Hooks
  </a>
  
    <nav class="md-nav" aria-label="Hooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sitename-hook" class="md-nav__link">
    SiteName hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avail-hook" class="md-nav__link">
    avail hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msghook" class="md-nav__link">
    msgHook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visibility-hook" class="md-nav__link">
    Visibility hook
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-lmod-functions" class="md-nav__link">
    Custom LMOD functions
  </a>
  
    <nav class="md-nav" aria-label="Custom LMOD functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detect_lumi_partition" class="md-nav__link">
    detect_LUMI_partition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_cpe_component" class="md-nav__link">
    get_CPE_component
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_cpe_versions" class="md-nav__link">
    get_CPE_versions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_versionedfile" class="md-nav__link">
    get_versionedfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_hostname" class="md-nav__link">
    get_hostname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_user_prefix_easybuild" class="md-nav__link">
    get_user_prefix_EasyBuild
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_init_module_list" class="md-nav__link">
    get_init_module_list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_motd" class="md-nav__link">
    get_motd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_fortune" class="md-nav__link">
    get_fortune
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_interactive" class="md-nav__link">
    is_interactive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_lts_lumi_stack" class="md-nav__link">
    is_LTS_LUMI_stack
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_11">
          Toolchain documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Toolchain documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Toolchain documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Toolchains/toolchain_common/" class="md-nav__link">
        EasyBuild toolchains common options
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Toolchains/toolchain_cpe_common/" class="md-nav__link">
        Common information to all cpe* toolchains
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Toolchains/cpeCray/" class="md-nav__link">
        cpeCray toolchain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Toolchains/cpeGNU/" class="md-nav__link">
        cpeGNU toolchain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Toolchains/cpeAOCC/" class="md-nav__link">
        cpeAOCC toolchain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configurations/" class="md-nav__link">
        Configurations on LUMI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_12">
          Documentation on our EasyBlocks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Documentation on our EasyBlocks" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Documentation on our EasyBlocks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../CrayPEToolchain/" class="md-nav__link">
        The CrayPEToolchain EasyBlock
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" type="checkbox" id="__nav_13" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_13">
          Archive
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Archive" data-md-level="1">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          Archive
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../failed_experiments/" class="md-nav__link">
        Failed experiments
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#settings" class="md-nav__link">
    Settings
  </a>
  
    <nav class="md-nav" aria-label="Settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#target-modules-per-partition" class="md-nav__link">
    Target modules per partition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-programming-environment" class="md-nav__link">
    Default programming environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-of-lts-software-stacks" class="md-nav__link">
    List of LTS software stacks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hooks" class="md-nav__link">
    Hooks
  </a>
  
    <nav class="md-nav" aria-label="Hooks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sitename-hook" class="md-nav__link">
    SiteName hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avail-hook" class="md-nav__link">
    avail hook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#msghook" class="md-nav__link">
    msgHook
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visibility-hook" class="md-nav__link">
    Visibility hook
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-lmod-functions" class="md-nav__link">
    Custom LMOD functions
  </a>
  
    <nav class="md-nav" aria-label="Custom LMOD functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detect_lumi_partition" class="md-nav__link">
    detect_LUMI_partition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_cpe_component" class="md-nav__link">
    get_CPE_component
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_cpe_versions" class="md-nav__link">
    get_CPE_versions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_versionedfile" class="md-nav__link">
    get_versionedfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_hostname" class="md-nav__link">
    get_hostname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_user_prefix_easybuild" class="md-nav__link">
    get_user_prefix_EasyBuild
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_init_module_list" class="md-nav__link">
    get_init_module_list
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_motd" class="md-nav__link">
    get_motd
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_fortune" class="md-nav__link">
    get_fortune
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_interactive" class="md-nav__link">
    is_interactive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_lts_lumi_stack" class="md-nav__link">
    is_LTS_LUMI_stack
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/Lumi-supercomputer/LUMI-SoftwareStack/edit/master/docs/SitePackage.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="lumi-prototype-sitepackagelua">LUMI prototype SitePackage.lua<a class="headerlink" href="#lumi-prototype-sitepackagelua" title="Permanent link">&para;</a></h1>
<p>SitePackage.lua is used to implement various customistations to Lmod.</p>
<p>The file defines both LMOD hooks and a number of new functions for the sandbox to ease
the implementation of modulefiles for LUMI.</p>
<p>Make sure that the environment variable <code>LMOD_PACKAGE_PATH</code> points to the directory
that contains this file to activate this file.</p>
<h2 id="settings">Settings<a class="headerlink" href="#settings" title="Permanent link">&para;</a></h2>
<h3 id="target-modules-per-partition">Target modules per partition<a class="headerlink" href="#target-modules-per-partition" title="Permanent link">&para;</a></h3>
<p>The target modules per partition are set via the init_module_list table. This also
includes other modules that are set at initialisation.</p>
<h3 id="default-programming-environment">Default programming environment<a class="headerlink" href="#default-programming-environment" title="Permanent link">&para;</a></h3>
<p>The default programming environment is set via the init_PrgEnv variable.</p>
<h3 id="list-of-lts-software-stacks">List of LTS software stacks<a class="headerlink" href="#list-of-lts-software-stacks" title="Permanent link">&para;</a></h3>
<p>In the initial implementation every software stack that was not a development stack
was marked as "LTS" but it turns out it will be very difficult initially to live up
to the promise of 2 years of support. We simply need to change the programming
environment too often and HPE Cray also does not keep supporting them.</p>
<p>The LUMI-stacks with long-term support are set in LTS_LUMI_stacks</p>
<h2 id="hooks">Hooks<a class="headerlink" href="#hooks" title="Permanent link">&para;</a></h2>
<h3 id="sitename-hook">SiteName hook<a class="headerlink" href="#sitename-hook" title="Permanent link">&para;</a></h3>
<p>This hook is used to define the prefix for some of the environment variables that
Lmod will generate internally. Rather then just setting it to <code>LUMI</code> we decided to
set it to <code>LUMI_LMOD</code> to lower the chance of conflicts with environment variables
that may be defined elsewhere.</p>
<h3 id="avail-hook">avail hook<a class="headerlink" href="#avail-hook" title="Permanent link">&para;</a></h3>
<p>This hook is used to replace directories with labels in the output of <code>module avail</code>.</p>
<p>To work for the prototypes, one needs to set:
<div class="highlight"><pre><span></span><code><span class="nb">export</span> <span class="nv">LMOD_AVAIL_STYLE</span><span class="o">=</span>&lt;label&gt;:PEhierarchy:system
</code></pre></div>
which will make the labeled view the default but will still allow to see the directory
view using
<div class="highlight"><pre><span></span><code>module -s system avail
</code></pre></div></p>
<p>The <code>ModuleLabel</code> modules can also be used to switch between the three settings:</p>
<ul>
<li>
<p><code>label</code>: User-friendly labels for the directories, some directories collapsed into
    a single category, and all Cray PE modules collapsed into a single category.</p>
</li>
<li>
<p><code>PEhierarchyy</code>: User-friendly labels for the directories, some directories collapsed into
    a single category, but with the original Cray PE module hierarchy.</p>
</li>
<li>
<p><code>system</code>: The view showing the full directory path for each module directory.</p>
</li>
</ul>
<h3 id="msghook">msgHook<a class="headerlink" href="#msghook" title="Permanent link">&para;</a></h3>
<p>This hook is used to adapt the following messages:
  * output of <code>module avail</code>:  Add more information about how to search for software
    and to contact LUMI User Support.</p>
<h3 id="visibility-hook">Visibility hook<a class="headerlink" href="#visibility-hook" title="Permanent link">&para;</a></h3>
<p>The visibility hook is currently used to hide the Cray modules of other CPE versions
in a particular version of the CPE software stack. As the hook function is called many
times during a single call to <code>module avail</code> some effort was done to make it efficient
at the cost of readability.</p>
<ul>
<li>
<p>The data about the modules that should not be hidden is contained in a LUA script
    in <code>mgmt/LMOD/VisibilityHookData</code>. This script is read via <code>require</code> so that
    it is cached and really processed only once. Furthermore, to make locating the
    script easy, the LUMI stack module stores the path and name in two environment
    variables that are ready-to-use without further substitutions.</p>
<p>The file is auto-generated during the initialisation of a software stack.</p>
<p>The name and location of the file is set through two environment variables set
in the LUMI modules.</p>
</li>
<li>
<p>Note that the feature is turned of for power users.</p>
</li>
</ul>
<h2 id="custom-lmod-functions">Custom LMOD functions<a class="headerlink" href="#custom-lmod-functions" title="Permanent link">&para;</a></h2>
<h3 id="detect_lumi_partition">detect_LUMI_partition<a class="headerlink" href="#detect_lumi_partition" title="Permanent link">&para;</a></h3>
<p><code>detect_LUMI_partition</code>is a function that can be used to request the current LUMI
partition. This is used by the generic <code>modules/LUMIstack</code> modules files but put
in <code>SitePackage.lua</code> to have a single point where this is implemented.</p>
<p>The alternative would be to use a trick that is also used in some CPE module
files to read in and execute code from an external file.</p>
<p>LUMI_OVERWRITE_PARTITION is defined and if so, the value of that variable is used.
It is assumed to be C, G, D or L depending on the node type (CPU compute, GPU compute,
data and visualisation or login), or can be common to install software in the
hidden common partition.</p>
<p>Currently the following rules are implemented for LUMI:</p>
<ul>
<li>
<p>Node name starts with <code>uan</code>:  It must be a login node, so in partition/L</p>
</li>
<li>
<p>Nude number 16-23: LUMI-D with GPU</p>
</li>
<li>
<p>Node number 101-108: LUMI-D without GPY, assing to partition/L</p>
</li>
<li>
<p>Node number 1000-2535: Regular LUMI-C compute nodes, assign partition/C</p>
</li>
<li>
<p>Other nodes are for now assigned to partition/L.</p>
</li>
</ul>
<p>The idea is to ensure that a <code>module update</code> would reload the loaded software
stack for the partition on which the <code>module update</code> command is run.</p>
<h3 id="get_cpe_component">get_CPE_component<a class="headerlink" href="#get_cpe_component" title="Permanent link">&para;</a></h3>
<p><code>get_CPE_component</code> is a function that can be used in modulefiles to request
the version of a CPE component. The data is read from the CPE definition files
in the <code>CrayPE</code> subdirectory of the repository.</p>
<p>The function is currently used in the <code>modules/LUMIpartition</code> generic implementation
of the partition modules for the LUMI stacks to determine the version of the
Cray targeting modules to add that directory to the MODULEPATH.</p>
<h3 id="get_cpe_versions">get_CPE_versions<a class="headerlink" href="#get_cpe_versions" title="Permanent link">&para;</a></h3>
<p><code>get_CPE_versions</code> is a function that can be used in module files to request
a table with the version for each package in a CPE release. The data is read
from the CPE definition files in the <code>CrayPE</code> subdirectory of the repository.</p>
<p>The function is used in the prototype in the <code>cpe</code> modules for the Grenoble
system as a proof-of-concept for a generic <code>cpe</code> module to reduce the number
of places where the version info of the Cray packages in a CPE release is kept.</p>
<h3 id="get_versionedfile">get_versionedfile<a class="headerlink" href="#get_versionedfile" title="Permanent link">&para;</a></h3>
<p><code>get_versionedfile</code> is a function that can be used to find the suitable versioned
file for a given version of the LUMI software stack, i.e., the file which according
to the version number is the most recent one not newer than the software stack.</p>
<h3 id="get_hostname">get_hostname<a class="headerlink" href="#get_hostname" title="Permanent link">&para;</a></h3>
<p><code>get_hostname</code> gets the hostname from the output of the <code>hostname</code> command.
It is meant to be used by detect_LUMI_partition but is also exported so that other
module files can use it if needed.</p>
<h3 id="get_user_prefix_easybuild">get_user_prefix_EasyBuild<a class="headerlink" href="#get_user_prefix_easybuild" title="Permanent link">&para;</a></h3>
<p><code>get_user_prefix_EasyBuild</code> computes the root of the user EasyBuild installation
from the environment variable <code>EBU_USER_PREFIX</code> and the default name in the home
directory.</p>
<p>It is used in the <code>EasyBuild-config</code> module, the <code>LUMIpartition</code> module (to include
the user module directory in the <code>MODULEPATH`) and in the</code>avail_hook`` LMOD hook.</p>
<h3 id="get_init_module_list">get_init_module_list<a class="headerlink" href="#get_init_module_list" title="Permanent link">&para;</a></h3>
<p><code>get_init_module_list</code> is a function that returns the list of modules to load at
initialisation. This includes target modules, other modules, and optionally the
default programming environment.</p>
<p>The function takes two arguments:</p>
<ol>
<li>
<p>The partition (L, C, G, D)</p>
</li>
<li>
<p>A boolean: When true the default programming environment is added to the list of
    modules that is generated as a result of the function.</p>
</li>
</ol>
<h3 id="get_motd">get_motd<a class="headerlink" href="#get_motd" title="Permanent link">&para;</a></h3>
<p><code>get_motd</code> returns the message-fo-the-day as stored in <code>etc/motd</code> in the repository
root. The function takes no input arguments.</p>
<h3 id="get_fortune">get_fortune<a class="headerlink" href="#get_fortune" title="Permanent link">&para;</a></h3>
<p><code>get_fortune</code> works as the old UNIX <code>fortune</code> command. It returns a random tip
read from <code>etc/lumi_fortune.txt</code> in the repository root.</p>
<h3 id="is_interactive">is_interactive<a class="headerlink" href="#is_interactive" title="Permanent link">&para;</a></h3>
<p><code>is_interactive</code> returns true if it is called in an interactive shell, otherwise
false. The function takes no input arguments.</p>
<p>It is used to ensure that the message-of-the-day is not printed in cases where Linux
would not print it.</p>
<h3 id="is_lts_lumi_stack">is_LTS_LUMI_stack<a class="headerlink" href="#is_lts_lumi_stack" title="Permanent link">&para;</a></h3>
<p><code>is_LTS_LUMI_stack</code> takes one input argument: the version of the LUMI stack. It returns
true if that version is a LTS stack and returns false otherwise.</p>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../files_used/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview of files" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Overview of files
            </div>
          </div>
        </a>
      
      
        
        <a href="../Toolchains/toolchain_common/" class="md-footer__link md-footer__link--next" aria-label="Next: EasyBuild toolchains common options" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              EasyBuild toolchains common options
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://www.youtube.com/channel/UCb31KOJ6Wqu0sRpIRi_k8Mw" target="_blank" rel="noopener" title="LUMI on YouTube" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
    <a href="https://www.linkedin.com/company/lumi-supercomputer" target="_blank" rel="noopener" title="LUMI on LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    <a href="https://twitter.com/LUMIhpc" target="_blank" rel="noopener" title="LUMI on Twitter" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "navigation.indexes", "header.autohide", "toc.follow"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>